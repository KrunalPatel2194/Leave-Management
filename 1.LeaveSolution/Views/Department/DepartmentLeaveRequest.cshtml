@model BlueCollaredLeaveSolution.Models.DeptLeaveRequestViewModel
@{
    ViewData["Title"] = "DepartmentLeaveRequest";
    Layout = "~/Views/Shared/_Layout.cshtml";

}
@section Scripts{
    <meta charset="utf-8">
    <link href="~/Calander/jquery-ui.css" rel="stylesheet" />
    <link href="~/css/dataTables.bootstrap.min.css" rel="stylesheet" />
    <link href="~/lib/bootstrap/dist/css/EmpDeptHolidayColor.css" rel="stylesheet" />
    <script src="~/Calander/jquery-ui.js"></script>
    <script src="~/js/jquery.dataTables.min.js"></script>
    <script src="~/Datepicker/moment.js"></script>
    <script src="~/Datepicker/bootstrap-datetimepicker.js"></script>
    <script>
        function uploadFiles(inputId) {
            var input = document.getElementById(inputId);
            var files = input.files;
            var formData = new FormData();
            setTimeout(function () {
                $("#loader").show();
            }, 0);
            formData.append("file", files[0]);
            $.ajax(
                {
                    url: "@Url.Action("UploadFile", "Department")",
                    data: formData,
                    processData: false,
                    contentType: false,
                    type: "POST", beforeSend: function () { $("#loader").show();},
                    success: function (data) {
                        $("#loader").hide();
                        if (data.returndata == false) {
                            alert(data.msg);
                            return false
                        }
                        else {
                            if (data.length != 0) {
                                //   alert("here");
                                $('#ConfirmSave').modal({
                                    backdrop: 'static',
                                    keyboard: false
                                })
                                $("#ConfirmSave").modal("show");
                                var my_columns = [];
                                var my_item = {};
                                my_item.data = 'employeeID';
                                my_item.title = 'Employee ID';
                                my_columns.push(my_item);
                                var my_item = {};
                                my_item.data = 'fromDate';
                                my_item.title = 'From Date';
                                my_columns.push(my_item);
                                var my_item = {};
                                my_item.data = 'toDate';
                                my_item.title = 'To Date';
                                my_columns.push(my_item);
                                var my_item = {};
                                my_item.data = 'leaveCode';
                                my_item.title = 'Leave Code';
                                my_columns.push(my_item);
                                var my_item = {};
                                my_item.data = 'errormsg';
                                my_item.title = 'Error Msg';
                                my_columns.push(my_item);

                                $('#TblErrorList').DataTable({
                                    "destroy": true,
                                    data: data.errorList,
                                    "columns": my_columns
                                });
                                $('#ConfirmSave').modal({
                                    backdrop: 'static',
                                    keyboard: false
                                });
                            }
                        }
                    },
                    error: function () {
                        $("#loader").hide();
                    }
                }
            );
        }
        function validateleaverequest() {
            var LeaveID = $("#LeavelistId").val();
            var FromDate = $("#FromDate").val();;
            var ToDate = $("#ToDate").val();
            var approver = $("#approverId").val();
            var msg = "";
            var returnmsg = true;

            if (LeaveID == "" || LeaveID == "0") {
                msg += "Please select leave cateogory" + "\n";
                returnmsg = false;
            }
            if (FromDate == "") {
                msg += "Please enter from date" + "\n";
                returnmsg = false;
            }
            if (ToDate == "") {
                msg += "Please enter to date" + "\n";
                returnmsg = false;
            }
            if (approver == "") {
                msg += "Please select approver" + "\n";
                returnmsg = false;
            }
            if ($("input:radio[name='LeaveShift']").is(":checked") == false) {
                msg += "Please select leave type" + "\n";
                returnmsg = false;
            }
            if (returnmsg == false) {
                alert(msg);
            }
            return returnmsg;
        }

        $(document).ready(function () {
            $("#LeavelistId").on("change", function () {
                // $("#loader").show();
                $("#LeaveCategory").val($(this).find("option:selected").text());
            });

            var year = (new Date).getFullYear();
            $("#FromDate").datepicker({
                // beforeShowDay: setHoliDays,
                dateFormat: 'dd/mm/yy',
                minDate: new Date(year, 0, 1),
                maxDate: new Date(year, 11, 31),
                onSelect: function (selectedDate) {//when click on calander then select date
                    $(".datepicker").datepicker({ maxDate: '0' });
                    var todate = $("#ToDate").val();
                    var LeaveShift = $('input[name=LeaveShift]:checked').val();
                    if (LeaveShift == "F" || LeaveShift == "S") {
                        $("#ToDate").val(selectedDate);
                        $("#FromDate").val(selectedDate);
                    }
                    else if (todate != "" && todate < selectedDate) {
                        $("#FromDate").val("");
                    }
                }
            });
            $("#ToDate").datepicker({
                // beforeShowDay: setHoliDays,
                dateFormat: 'dd/mm/yy', minDate: new Date(year, 0, 1),
                maxDate: new Date(year, 11, 31),
                onSelect: function (selectedDate) {//when click on calander then select date
                    var LeaveShift = $('input[name=LeaveShift]:checked').val();
                    if (LeaveShift == "F" || LeaveShift == "S") {
                        $("#FromDate").val(selectedDate);
                        $("#ToDate").val(selectedDate);
                    }
                    var fromdate = $("#FromDate").val();
                    var todate = $("#ToDate").val();
                    var ffdate = new Date(fromdate.split('/')[2] + "-" + fromdate.split('/')[1] + "-" + fromdate.split('/')[0]);
                    var ttdate = new Date(todate.split('/')[2] + "-" + todate.split('/')[1] + "-" + todate.split('/')[0]);
                    if (fromdate == "" || ffdate <= ttdate) {
                    }
                    else {
                        $("#ToDate").val("");
                        return;
                    }
                }
            });

            $("#btnYes").click(function () {
               $("#loader").show();
                var url = '@Url.Content("~/")' + "Department/UploadSaveConfirm";
                $.getJSON(url, {userdata:"YES" }, function (data) {
                    if (data.result == true) {
                        alert(data.msg);
                    }
                    else {
                        alert(data.msg);
                    }
                    window.location.href = "@Url.Action("DepartmentLeaveRequest", "Department")";
                }).fail(function () {
                    $("#loader").hide();
                    alert("error");
                    window.location.href = "@Url.Action("DepartmentLeaveRequest", "Department")"
                });
            });
                //$.getJSON.post(url)

            $("#btnNo").click(function () {
                 $("#loader").show();
                var url = '@Url.Content("~/")' + "Department/UploadSaveConfirm";
                $.getJSON(url, {userdata:"NO" }, function (data) {
                     if (data.result == true) {
                         alert("Changes deleted successfully.");
                    }
                    else {
                        alert(data.msg);
                    }
                    window.location.href = "@Url.Action("DepartmentLeaveRequest", "Department")"
                    $("#loader").hide();
                }).fail(function () {
                    $("#loader").hide();
                    alert("error");
                });
            });
            //SAP code
            $("#ValidationID").click(function () {
                if (validateleaverequest()) {
                    $("#loader").show();
                    var changeflag = '@ViewBag.IsChangeLeave';
                    var url = '@Url.Content("~/")' + "Department/ValidationFromSAP"
                    var LeaveID = $("#LeavelistId").val();
                    //alert(LeaveID);
                    var FromDate = $("#FromDate").val();;
                    var ToDate = $("#ToDate").val();
                    var EmployeeID = $("#txtautoEmpID").val();
                    var LeaveShift = "";
                    LeaveShift = $('input[name=LeaveShift]:checked').val();

                    $.getJSON(url, { LeaveID: LeaveID, FromDate: FromDate, ToDate: ToDate, LeaveShift: LeaveShift, employeeid: EmployeeID }, function (data) {
                        //alert(data.valid);
                        if (data.flag == true) {
                            alert("Data is valid.\nPlease click on send button for leave request.");
                            $("#SendDeptLeave").removeAttr("disabled");
                        }
                        else {
                            alert(data.valid);
                            $("#SendDeptLeave").removeAttr("disabled");
                            // window.location.reload(1);
                        }
                        $("#loader").hide();
                    }).fail(function () {
                        $("#loader").hide();
                        alert("error");
                    });
                }
            });

            $('#SelectedOrderType2').on('click', function () {
                var fromdate = $("#FromDate").val();
                var todate = $("#ToDate").val();
                if (fromdate == "" && todate != "") {
                    $("#FromDate").val(todate);
                }
                if (todate == "" && fromdate != "") {
                    $("#ToDate").val(fromdate);
                }
                if (fromdate != "" && todate != "" && fromdate != todate) {
                    $("#FromDate").val("");
                    $("#ToDate").val("");
                    alert("From date and To date must be same");
                    return false;
                }
            });
            $('#SelectedOrderType3').on('click', function () {
                var fromdate = $("#FromDate").val();
                var todate = $("#ToDate").val();
                if (fromdate == "" && todate != "") {
                    $("#FromDate").val(ttdate);
                }
                if (todate == "" && fromdate != "") {
                    $("#ToDate").val(ffdate);
                }
                if (fromdate != todate && fromdate != "" && todate != "") {
                    $("#FromDate").val("");
                    $("#ToDate").val("");
                    alert("From date and To date must be same");
                    return false;
                }
            });
            $(document).on('keyup keypress', 'form input[type="text"]', function (e) {
                if (e.which == 13) {
                    e.preventDefault();
                    return false;
                }
            });
            ///////////added////
            $('#rbEmpSingleFileId').click(function () {
                $("#loader").show();
                $('#deptId').hide();
                $('#dvFile').hide();
                $('#empId').show();
                $('#EmployeeDetails').show();
                $("#loader").hide();
            });
            $('#rbEmpMultipleFileId').click(function () {
                $("#loader").show();
                $('#deptId').show();
                $('#dvFile').show();
                $('#empId').hide();
                $('#EmployeeDetails').hide();
                $("#loader").hide();
            });
            $("#SendDeptLeave").click(function () {
                //alert($("#LeaveShift").val());
                if ($("input[name='item.Value']:checked").val() == "EmpMultipleFile") {
                    if (!validatemultipledeptleave()) {
                        return false;
                    }
                }
                else if ($("input[name='item.Value']:checked").val() == "EmpSingleFile") {
                    if (!validatedeptleave()) {
                        return false;
                    }
                }
                else {
                    return false;
                }
                var empName = $("#EmployeeName").text();
                $("#EmployeeName1").val(empName);
                var empphoneNo = $("#empphoneNo").text();//new add
                $("#empphoneNo1").val(empphoneNo);
                var val = $("input[name='LeaveShift']:checked").val();
                //alert(val);
                $("#Shift").val(val);
            });

            $("#btnUploadExcel").click(function () {
                $("#loader").show();
                if ($("input[name='item.Value']:checked").val() == "EmpMultipleFile") {
                    if (!validatemultipledeptleave()) {
                        return false;
                    }
                    else {
                        uploadFiles('btnfileupload');
                    }
                }

                else if ($("input[name='item.Value']:checked").val() == "EmpSingleFile") {
                    if (!validatedeptleave()) {
                        return false;
                    }
                }
                else {
                    return false;
                }
                $("#loader").hide();
            });

            $(document).on('keyup keypress', 'form input[type="text"]', function (e) {
                if (e.which == 13) {
                    e.preventDefault();
                    return false;
                }
            });

            $('#txtautoEmpID').change(function () {
                $("#loader").show();
                var url = '@Url.Content("~/")' + "Department/GetEmployeeDetails";
                $.getJSON(url, { Empid: $("#txtautoEmpID").val() }, function (data) {
                    if (data.result == true) {
                        var data = data.data;
                        $("#EmployeeName").text(data.employeeName);
                        var empname = $("#EmployeeName").val(data.employeeName);
                        $("#empphoneNo").text(data.empphoneNo);
                        var empphoneNo = $("#empphoneNo1").val(data.empphoneNo);
                        $("#Grade").text(data.grade);
                        $("#PA").text(data.pa);
                        $("#PSA").text(data.psa);
                        $("#approverId").attr('readonly', false);
                        if (data.approverName != "" && data.approverId != "") {
                            $("#approverId").val(data.approverId);
                        }
                        $("#divempdetails").show();
                        $("#approverId").attr('readonly', true);
                        getdeplleaves();

                    }
                    else {
                        $("#divempdetails").hide();
                        $("#loader").hide();
                        alert("Employee does not exists.");
                        window.location.reload(1);
                    }
                });
            });
            $("#loader").hide();
        });
    </script>

    <script type="text/javascript" language="javascript">
        function ValidateSize(file) {
            var ext = $(file).val().split('.').pop();
            var FileSize = file.files[0].size / 1024 / 1024; // in MB
            if (ext != "pdf") {
                alert("Please upload only PDF file");
                $(file).val(''); //for clearing with Jquery
                return false;
            }
            else if (FileSize > 2) {
                alert('File size exceeds 2 MB.');
                $(file).val(''); //for clearing with Jquery
                return false;
            } else {
                return true;
            }
        }

        function ValidateSizeExcel(file) {
            var ext = $(file).val().split('.').pop();
            var FileSize = file.files[0].size / 1024 / 1024; // in MB
            if (ext != "xlsx") {
                alert("Please upload only Excel(.xlsx) file");
                $(file).val(''); //for clearing with Jquery
                return false;
            }
            else if (FileSize > 2) {
                alert('File size exceeds 2 MB.');
                $(file).val(''); //for clearing with Jquery
                return false;
            } else {
                return true;
            }
        }

        function checkfile(sender) {
            var validExts = new Array(".xlsx");
            var fileExt = sender.value;
            fileExt = fileExt.substring(fileExt.lastIndexOf('.'));
            if (validExts.indexOf(fileExt) < 0) {
                alert("Invalid file selected, valid files are of " +
                    validExts.toString() + " types.");
                document.getElementById("BlobUploadForm").reset();
                return false;
            }
            else return true;
        }
    </script>
    <style>
        .square {
            height: 12px;
            width: 13px;
            margin-left: 8px;
            FONT-SIZE: 13px;
        }

        .fontsize {
            font-size: 1.4rem;
        }

        .filecontrolheight {
            height: 39px;
            margin-top: 18px;
        }

        .Uploadbtn {
            margin-top: 10px;
        }

        .Linkbtn {
            text-decoration: none;
            border-bottom: 1px solid blue;
            color: darkblue;
            font-size: 15px;
            margin-left: 50%;
        }
    </style>
    <style type="text/css">
        /*For Working Day*/
        .ui-datepicker td.a, .ui-datepicker td.WorkingDay a:hover {
            background: none #ffffff !important;
            border: 1px solid #BF5A0C;
        }

        .ui-state-default {
            background: none #ffffff;
            border: 1px solid #BF5A0C;
        }
        /*For Non-Working Day*/
        .ui-datepicker td.NonWorkingDay a, .ui-datepicker td.NonWorkingDay a:hover {
            background: none #adaaaa !important;
            border: 1px solid #BF5A0C;
        }

        .ui-state-default {
            background: none #adaaaa;
            border: 1px solid #BF5A0C;
        }
        /*For Approved*/
        .ui-datepicker td.Approved a, .ui-datepicker td.Approved a:hover {
            background: none #baecf1 !important;
            border: 1px solid #BF5A0C;
        }

        td.Approved span.ui-state-default {
            background: none #baecf1 !important;
            border: 1px solid #BF5A0C;
        }

        .ui-state-default {
            background: none #baecf1;
            border: 1px solid #BF5A0C;
        }

        /*For Approval Pending*/
        .ui-datepicker td.ApprovalPending a, .ui-datepicker td.ApprovalPending a:hover {
            background: none #cfe5e8 !important;
            border: 1px solid #BF5A0C;
        }

        td.ApprovalPending span.ui-state-default {
            background: none #cfe5e8 !important;
            border: 1px solid #BF5A0C;
        }

        .ui-state-default {
            background: none #cfe5e8;
            border: 1px solid #BF5A0C;
        }
        /*For Public Holiday*/
        .ui-datepicker td.publicholiday a, .ui-datepicker td.publicholiday a:hover {
            background: none #e6dc70 !important;
            border: 1px solid #BF5A0C;
        }

        td.publicholiday span.ui-state-default {
            background: none #e6dc70 !important;
            border: 1px solid #BF5A0C;
        }

        .ui-state-default {
            background: none #e6dc70;
            border: 1px solid #BF5A0C;
        }
    </style>

    <script>
         function getdeplleaves() {
            var url = '@Url.Content("~/")' + "Department/GetLeaveRequestList";
                $.getJSON(url, { leaveId: "" }, function (data) {
                    $("#LeavelistId").attr("disabled", false);
                    $("#FromDate").attr("disabled", false);
                    $("#ToDate").attr("disabled", false);
                    $("#SelectedOrderType1").attr("disabled", false);
                    $("#SelectedOrderType2").attr("disabled", false);
                    $("#SelectedOrderType3").attr("disabled", false);
                if (data.length == 0) {
                    var items = '<option value="0" hidden >No Data For Selected Leave</option >';
                    $("#LeavelistId").empty();
                    $('#LeavelistId').html(items);
                }
                else {
                    var items = '<option value="0" hidden > ---Please Select--- </option >';
                    $("#LeavelistId").empty();
                    $.each(data, function (i, Leave) {
                        items += "<option value='" + Leave.value + "'>" + Leave.text + "</option>";
                    });
                    $('#LeavelistId').html(items);
                }
                $("#loader").hide();
                }).fail(function () {
                    $("#loader").hide();
                });
        }

        function validatedeptleave() {
            var result = true;
            if ($("#FromDate").val() == "") {
                $("#errorFromDate").show();
                result = false;
            }
            else {
                $("#errorFromDate").hide();
            }
            if ($("input[name='LeaveShift']:checked").length == 0) {
                $("#errorLeaveShift").show();
                result = false;
            }
            else {
                $("#errorLeaveShift").hide();
            }
            if ($("#ToDate").val() == "") {
                $("#errorToDate").show();
                result = false;
            }
            else {
                $("#errorToDate").hide();
            }
            if ($("#txtautoEmpID").val() == "") {
                $("#errorEmployeeID").show();
                result = false;
            }
            else {
                $("#errorEmployeeID").hide();
            }
            if ($("#LeavelistId").val() == "" || $("#LeavelistId").val() == "0") {
                $("#errorLeavelistId").show();
                result = false;
            }
            else {
                $("#errorLeavelistId").hide();
            }
            if ($("#AbsenceCEHour").val() == "") {
                $("#errorAbsenceCEHour").show();
                result = false;
            }
            else {
                $("#errorAbsenceCEHour").hide();
            }
            if ($("#ApproverName").val() == "" || $("#ApproverName").val() == "_") {
                $("#errorApproverName").show();
                result = false;
            }
            else {
                $("#errorApproverName").hide();
            }
            return result;
        }

        function validatemultipledeptleave() {
            var validate = true;
            if ($("#btnfileupload").val() == "") {
                alert("Please select file")
                result = false;
            }
            return validate;
        }
    </script>
    <style>
        .radiobutton {
            margin-right: 11%;
            font-size: 84%;
        }

        .Row {
            display: table;
            width: 66%;
        }

        .Column {
            display: table-cell;
            background-color: red;
        }
    </style>
}
<section class="content">
    <div class="col-xs-12">
        <div class="box box-primary">
            <div class="box-header">
                <h3 class="box-title">
                    Department Leave Request
                </h3>
            </div>
            <input type="hidden" value="@Model.LeaveRequestId" name="LeaveRequestId" id="LeaveRequestId" />
            <div class="box-body">
                <div class="form-group text-center row">
                    <label class="radio-inline ">
                        <input type="radio" autocomplete="off" value="EmpSingleFile" checked="checked" id="rbEmpSingleFileId" name="item.Value" />
                        For Single Employee
                    </label> &nbsp; &nbsp;
                    <label class="radio-inline">
                        <input type="radio" autocomplete="off" value="EmpMultipleFile" id="rbEmpMultipleFileId" name="item.Value" />For Multiple Employee<br />
                    </label>
                </div>
                <div id="empId">
                    <form action="DepartmentLeaveRequest" method="post" class="form-horizontal" id="demo">
                        <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                        @*@Html.HiddenFor(model => model.EmployeeName)*@
                        <div id="EmployeeDetails">
                            <div class="form-group row">
                                <div class="col-lg-3">
                                    <label asp-for="EmployeeID"></label>
                                    <input asp-for="EmployeeID" autofocus autocomplete="off" id="txtautoEmpID" class="form-control" new { placeholder="Search Employee ID" } />
                                    <span id="errorEmployeeID" style="display:none" class="text-danger field-validation-error" data-valmsg-for="EmployeeID" data-valmsg-replace="true">Please select Employee ID</span>
                                </div>
                                <div class="col-lg-1"></div>
                                <div class="col-lg-3">
                                    <label asp-for="LeaveCategory"></label>
                                    <select asp-for="LeavelistId" class="form-control input multiSelect" disabled asp-items="@Model.Leavelist">
                                        <option value="" hidden>
                                            ---Select---
                                        </option>
                                    </select>
                                    <input type="hidden" autocomplete="off" id="LeaveCategory" name="LeaveCategory" value="" />
                                    <span id="errorLeavelistId" style="display:none" class="text-danger field-validation-error" data-valmsg-for="LeavelistId" data-valmsg-replace="true">Please select Leave Category</span>
                                </div>
                                <div class="col-lg-1"></div>
                                <div class="col-lg-4">
                                    <label class="control-label" asp-for="LeaveType"></label><br />
                                    <label class="radio-inline ">
                                        <input asp-for="LeaveShift" disabled class="control-label" type="radio" value="" id="SelectedOrderType1" name="LeaveShift" clientidmode="Static" />Full Day
                                    </label>
                                    <label class="radio-inline ">
                                        <input asp-for="LeaveShift" disabled class="control-label" type="radio" value="F" id="SelectedOrderType2" name="LeaveShift" clientidmode="Static" />First Half<br />
                                    </label>
                                    <label class="radio-inline ">
                                        <input asp-for="LeaveShift" disabled class="control-label" type="radio" value="S" id="SelectedOrderType3" name="LeaveShift" clientidmode="Static" />Second Half<br />
                                    </label><br />
                                    @*<span asp-validation-for="" class="text-danger"></span>*@
                                    <span id="errorLeaveShift" style="display:none" class="text-danger field-validation-error" data-valmsg-for="LeaveShift" data-valmsg-replace="true">Please select Shift</span>
                                    <input type="hidden" id="Shift" name="Shift" value="" />
                                </div>
                            </div>
                            <div class="form-group row" id="divempdetails" style="display:none">
                                <div class="col-lg-5">
                                    <label>Employee Name:</label>
                                    @Html.LabelFor(model => model.EmployeeName, htmlAttributes: new { @class = "label label-primary fontsize", @id = "EmployeeName" })
                                    <input type="hidden" autocomplete="off" name="EmployeeName1" id="EmployeeName1" />
                                    <label id="Grade" style="display:none;" class="label label-primary fontsize" asp-for="Grade">@Model.Grade</label>

                                </div>
                                <div class="col-lg-3">
                                    <label>PA</label>:
                                    <label id="PA" class="label label-primary fontsize" asp-for="PA">@Model.PA</label>
                                </div>
                                <div class="col-lg-3">
                                    <label>PSA</label>:
                                    <label id="PSA" class="label label-primary fontsize" asp-for="PSA">@Model.PSA</label>
                                </div>
                                <div style="display:none;">
                                    @Html.LabelFor(model => model.empphoneNo, htmlAttributes: new { @class = "label label-primary fontsize hidden ", @id = "empphoneNo" })
                                    <input type="hidden" autocomplete="off" name="empphoneNo1" id="empphoneNo1" />
                                </div>
                            </div>
                            <div class="form-group row">
                                <div class="col-lg-3">
                                    <label asp-for="FromDate"></label>@*disabled*@
                                    <input type="text" autocomplete="off" id="FromDate" readonly="readonly" class="form-control" asp-for="FromDate" new { placeholder="DD/MM/YYYY" } />
                                    <span id="errorFromDate" style="display:none" class="text-danger field-validation-error" data-valmsg-for="FromDate" data-valmsg-replace="true">Please Select From Date</span>
                                </div>
                                <div class="col-lg-1"></div>
                                <div class="col-lg-3">
                                    <label asp-for="ToDate"></label>
                                    <input type="text" autocomplete="off" id="ToDate" readonly="readonly" class="form-control" asp-for="ToDate" new { placeholder="DD/MM/YYYY" } />
                                    <span id="errorToDate" style="display:none" class="text-danger field-validation-error" data-valmsg-for="ToDate" data-valmsg-replace="true">Please Select To Date</span>
                                </div>
                                <div class="col-lg-1"></div>
                                <div class="col-md-3">
                                    <p><b>Document Upload</b></p>
                                    <input type="file" autocomplete="off" asp-for="FileToUpload" id="uploadfildID" onchange="ValidateSize(this)">
                                    <p style="color: #f70404;">Only upload PDF file.</p>
                                </div>
                                <div class="col-lg-3" style="display:none">
                                    FileToUpload
                                    <label asp-for="AbsenceCEHour"></label>
                                    <input asp-for="AbsenceCEHour" autocomplete="off" class="form-control" id="addtendanceId" />
                                    <span id="errorAbsenceCEHour" style="display:none" class="text-danger field-validation-error" data-valmsg-for="AbsenceCEHour" data-valmsg-replace="true">Please enter Hours</span>
                                </div>
                                <div class="col-lg-1"></div>
                            </div>
                            <div class="form-group row">
                                <div class="col-lg-3">
                                    <label asp-for="ApproverName"></label>
                                    <input asp-for="ApproverName" autocomplete="off" class="form-control" style="margin-bottom:5px;" readonly id="approverId" new { placeholder="Approver Name" } />
                                    <span id="errorApproverName" style="display:none" class="text-danger field-validation-error" data-valmsg-for="ToDate" data-valmsg-replace="true">Please enter Approver Name</span>
                                </div>
                                <div class="col-lg-1"></div>
                                <div class="col-lg-3">
                                    <label asp-for="Remarks"></label>
                                    <TEXTAREA type="text" class="form-control" multiple="text" id="noteId" asp-for="Remarks" new { placeholder="Remark" }></TEXTAREA>
                                </div>
                            </div><br />
                        </div><br />
                        <div class="box-footer">
                            <div class="col-lg-12 text-center">
                                <div class="row">
                                    <button type="button" commandtype="submit" name="v1" class="btn btn-warning" id="ValidationID">
                                        <span class="glyphicon glyphicon-exclamation-sign"></span>Validate
                                    </button>
                                    <button type="submit" commandtype="submit" name="v2" class="btn btn-success" disabled id="SendDeptLeave">
                                        <span class="glyphicon glyphicon-send "></span> Send
                                    </button>
                                    <button type="reset" class="btn btn-danger" onclick="window.location.href = window.location.href;">
                                        <span class="glyphicon glyphicon-refresh "></span>Reset
                                    </button>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>

                <div width="100%" id="deptId" style="display:none">
                    <form asp-controller="Department" asp-action="UploadFile" enctype="multipart/form-data" id="BlobUploadForm" method="post" class="form-label-left">
                        <div class="col-md-12 col-lg-12 col-xs-12 col-sm-12">
                            <div>
                                <div id="dvFile" class="text-center">
                                    <a class="" href="~/SampleFile/EployeeBulkLeaveRequest.xlsx"><b>Download Template</b></a>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-lg-4"></div>
                                <div class="col-lg-1" style="padding-top:20px;">
                                    <label class="form-check ">
                                        Upload File
                                    </label>
                                </div>
                                <div class="col-lg-4">
                                    <div class="input-group">
                                        <label class="input-group-btn">
                                            <input type="file" id="btnfileupload" asp-for="File" onchange="ValidateSizeExcel(this);" class="form-control filecontrolheight">
                                            <span id="errorFile" class="text-danger field-validation-error" data-valmsg-for="btnfileupload" data-valmsg-replace="true">Please upload File</span>
                                        </label>
                                    </div>
                                </div>
                                <div class="col-lg-3"></div>
                            </div>
                            <br />
                            <div class="row">
                                <div class="col-sm-12">
                                    <div class="text-center">
                                        <button type="button" id="btnUploadExcel" value="Upload File" class="btn btn-primary ">Upload</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
            <div class="modal fade" id="ApproveRequest" tabindex="-1" role="dialog" aria-labelledby="NUserModalLabel">
                <div class="modal-dialog" role="dialog">
                    <div class="modal-content">
                        <div class="modal-body text-center" id="EmpIDEnterID">
                            Please Enter EmployeeID
                        </div>
                        <div class="text-center" id="Centerbody">
                            <div class="form-group row">
                                <div class="col-form-label col-sm-4" style="font-size:medium">
                                    <label asp-for="EmployeeID"></label>
                                </div>
                                <div class="col-sm-6">
                                    <input asp-for="EmployeeID" class="form-control" type="text" />
                                    <span asp-validation-for="EmployeeID" class="text-danger"></span>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-success" data-dismiss="modal" data-toggle="modal" id="btnOk">Ok</button>
                                <button type="button" class="btn btn-warning" data-dismiss="modal" data-toggle="modal">Cancel</button>
                            </div>
                        </div>

                    </div>
                </div>
            </div>

            <div class="modal fade" id="ConfirmSave" tabindex="-1" role="dialog" aria-labelledby="NUserModalLabelG">
                <div class="modal-dialog modal-lg" role="dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h4 class="modal-title" id="NUserModalLabelG" style="color:blue">Confirm Save data</h4>
                        </div>
                        <div class="modal-body">
                            All Records can be saved Except following Record as it having some issues..Do you want to continue to save data?
                            <br />
                            <br />
                                <table id="TblErrorList" class="table table-striped table-bordered" style="width:100%;"></table>
                            <br />
                            <span style="color:blue">
                                Note:  <br />
                                1)You can save data now and correct data in excelsheet which having error and again upload file by removing already added data.
                                <br />
                                2)You can click on No and correct errored data and again upload excel with all data.
                            </span>

                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-facebook" data-dismiss="modal" data-toggle="modal" id="btnYes"> YES</button>
                            <button type="button" class="btn btn-primary" data-dismiss="modal" data-toggle="modal" id="btnNo"> NO</button>
                            @*  <button type="button" class="btn btn-default" onclick="location.href='@Url.Action("GenerateOTP", "Account", new {  })';return false;">OK</button>*@
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
